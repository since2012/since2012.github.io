(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{196:function(t,a,s){"use strict";s.r(a);var n=s(0),o=Object(n.a)({},function(){this.$createElement;this._self._c;return this._m(0)},[function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("div",{staticClass:"content"},[s("h1",{attrs:{id:"spring-boot-日期数据格式转换-jsonformat实例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot-日期数据格式转换-jsonformat实例","aria-hidden":"true"}},[t._v("#")]),t._v(" Spring Boot 日期数据格式转换@JsonFormat实例")]),t._v(" "),s("p",[t._v("需要保证是是默认的转换器，就是jackson的转换器")]),t._v(" "),s("p",[t._v("com.fasterxml.jackson.annotation.JsonFormat")]),t._v(" "),s("p",[t._v("一开始配置了下面转换器，@JsonFormat就不可用。")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Configuration")]),t._v("\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@EnableAspectJAutoProxy")]),t._v("\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@EnableWebMvc")]),t._v("\n"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@ComponentScan")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("basePackages "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"rugal.sample.controller"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"cn.xiaowenjie"')]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("SpringMVCApplicationContext")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("WebMvcConfigurerAdapter")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n"),s("span",{attrs:{class:"token comment"}},[t._v("//\t@Override")]),t._v("\n"),s("span",{attrs:{class:"token comment"}},[t._v("//\tpublic void configureMessageConverters(List<HttpMessageConverter<?>> converters) {")]),t._v("\n"),s("span",{attrs:{class:"token comment"}},[t._v("//\t\tGsonHttpMessageConverter messageConverter = new GsonHttpMessageConverter();")]),t._v("\n"),s("span",{attrs:{class:"token comment"}},[t._v("//\t\tList<MediaType> supportedMediaTypes = new ArrayList<>();")]),t._v("\n"),s("span",{attrs:{class:"token comment"}},[t._v("//\t\tsupportedMediaTypes.add(MediaType.APPLICATION_JSON);")]),t._v("\n"),s("span",{attrs:{class:"token comment"}},[t._v("//\t\tmessageConverter.setSupportedMediaTypes(supportedMediaTypes);")]),t._v("\n"),s("span",{attrs:{class:"token comment"}},[t._v("//\t\tconverters.add(messageConverter);")]),t._v("\n"),s("span",{attrs:{class:"token comment"}},[t._v("//\t}")]),t._v("\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])])]),s("h2",{attrs:{id:"spring-boot-日期数据格式转换-jsonformat实例-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot-日期数据格式转换-jsonformat实例-2","aria-hidden":"true"}},[t._v("#")]),t._v(" Spring Boot 日期数据格式转换@JsonFormat实例")]),t._v(" "),s("p",[t._v("pojo的bean里面通常会有Date类型的数据，直接通过@ResponseBody返回出去的是一个长整型时间戳（从1970到该变量时间的毫秒数），关于原因，网上很多，此处不细讲。如果想要返回自定义的日期格式，如：yyyymmddhhmmss，需做相关处理，网上有很多处理方式，大体都是继承、重写，比较复杂。实际上JSON已有注解@JsonFormat支持，使用实例：")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@JsonFormat")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("timezone "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"GMT+8"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" pattern "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"yyyyMMddHHmmss"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" Date createTime"),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("p",[t._v("作用：")]),t._v(" "),s("p",[t._v("1）入参时，请求报文只需要传入yyyymmddhhmmss字符串进来，则自动转换为Date类型数据。\n2）出参时，Date类型的数据自动转换为14位的字符串返回出去。")]),t._v(" "),s("p",[t._v("详细可参阅：")]),t._v(" "),s("p",[t._v("http://fasterxml.github.io/jackson-annotations/javadoc/2.0.0/com/fasterxml/jackson/annotation/JsonFormat.html")]),t._v(" "),s("h2",{attrs:{id:"相关的其他注解"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#相关的其他注解","aria-hidden":"true"}},[t._v("#")]),t._v(" 相关的其他注解")]),t._v(" "),s("ul",[s("li",[t._v("@JsonIgnoreProperties")])]),t._v(" "),s("p",[t._v("此注解是类注解，作用是json序列化时将Java bean中的一些属性忽略掉，序列化和反序列化都受影响。")]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@JsonIgnoreProperties")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("value "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{attrs:{class:"token string"}},[t._v('"word"')]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  \n")])])]),s("ul",[s("li",[t._v("@JsonIgnore")])]),t._v(" "),s("p",[t._v("此注解用于属性或者方法上（最好是属性上），作用和上面的@JsonIgnoreProperties一样。")]),t._v(" "),s("ul",[s("li",[t._v("@JsonSerialize\n此注解用于属性或者getter方法上，用于在序列化时嵌入我们自定义的代码，比如序列化一个double时在其后面限制两位小数点。 "),s("code",[t._v("@JsonSerialize(using = CustomDoubleSerialize.class)")])])]),t._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Component")]),t._v("\n"),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("CustomDateSerialize")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("JsonSerializer")]),s("span",{attrs:{class:"token generics function"}},[s("span",{attrs:{class:"token punctuation"}},[t._v("<")]),t._v("Date"),s("span",{attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n\t"),s("span",{attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("static")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("final")]),t._v(" SimpleDateFormat dateFormat "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{attrs:{class:"token class-name"}},[t._v("SimpleDateFormat")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{attrs:{class:"token string"}},[t._v('"MM-dd hh:mm"')]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n\t"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@Override")]),t._v("\n\t"),s("span",{attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{attrs:{class:"token function"}},[t._v("serialize")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Date date"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" JsonGenerator gen"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" SerializerProvider provider"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\t\t\t"),s("span",{attrs:{class:"token keyword"}},[t._v("throws")]),t._v(" IOException"),s("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" JsonProcessingException "),s("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tString formattedDate "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" dateFormat"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("format")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("date"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\tgen"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token function"}},[t._v("writeString")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("formattedDate"),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),s("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n``\n\n"),s("span",{attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@JsonDeserialize")]),t._v("\n 此注解用于属性或者setter方法上，用于在反序列化时可以嵌入我们自定义的代码，类似于上面的"),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@JsonSerialize")]),t._v("  "),s("span",{attrs:{class:"token annotation punctuation"}},[t._v("@JsonDeserialize")]),s("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("using "),s("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" CustomDateDeserialize"),s("span",{attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{attrs:{class:"token keyword"}},[t._v("class")]),s("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" ")])])])])}],!1,null,null,null);o.options.__file="spring-boot-json-format.md";a.default=o.exports}}]);